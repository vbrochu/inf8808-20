{"version":3,"sources":["src/groups.js","src/viz3.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["colors","groups","roles","d3","margin","top","right","bottom","left","svgSize","graphSize","setSizing","data","roleGroups","roleColors","loadViz3","scaleProperty","csv","then","g","generateG","appendAxes","appendGraphLabels","positionLabels","width","height","groupOrder","getSortedGroups","preprocess","xScale","setXScale","yScale","setYScale","colorScale","setColorScale","sortedKeys","sortKeys","stackedData","stack","offset","stackOffsetSilhouette","keys","value","d","key","drawXAxis","drawYAxis","area","x","i","year","y0","y1","Tooltip","append","attr","style","mouseover","selectAll","filter","a","select","mousemove","text","mouseleave","enter","on","document","getElementById","addEventListener","toggleProperty","button","property","getAttribute","remove","setAttribute","innerHTML","graphWidth","Math","min","self","innerWidth","graphHeight","setCanvasSize","normalize","emptyGroups","Object","forEach","thisYear","Date","getFullYear","yearLimit","element","roleId","parseInt","role","substr","find","row","push","count","yearSum","scaleLinear","domain","extent","range","rolesSum","groupsColors","entries","r","scaleOrdinal","call","axisBottom","tickSizeOuter","tickFormat","format","axisLeft","tickArguments","groupTotals","sort","b","map","e","order","indexa","findIndex","indexb","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","overlay","createErrorOverlay","body","appendChild","createElement","stackTrace","innerText","getParents","modules","parents","k","dep","Array","isArray","length","concat","Function","deps","cached","cache","some","cb"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;AAwBO,IAAMA,MAAM,GAAG;AAClB,YAAS,SADS;AAElB,gBAAa,SAFK;AAGlB,eAAY,SAHM;AAIlB,gBAAa,SAJK;AAKlB,WAAQ,SALU;AAMlB,SAAM,SANY;AAOlB,cAAW,SAPO;AAQlB,eAAY,SARM;AASlB,eAAY,SATM;AAUlB,2BAAwB,SAVN;AAWlB,aAAU,SAXQ;AAYlB,WAAQ,SAZU;AAalB,iBAAc,SAbI;AAclB,0BAAuB,SAdL;AAelB,6BAA0B,SAfR;AAgBlB,4BAAyB,SAhBP;AAiBlB,2BAAwB,SAjBN;AAkBlB,wBAAqB,SAlBH;AAmBlB,gBAAa,SAnBK;AAoBlB,cAAW;AApBO,CAAf;;AAuBA,IAAMC,MAAM,GAAG;AAClB,MAAI,QADc;AAElB,MAAI,QAFc;AAGlB,MAAI,QAHc;AAKlB,MAAI,YALc;AAMlB,MAAI,YANc;AAOlB,MAAI,YAPc;AASlB,KAAG,WATe;AAUlB,KAAG,WAVe;AAYlB,KAAG,YAZe;AAalB,KAAG,YAbe;AAclB,KAAG,YAde;AAelB,MAAI,YAfc;AAiBlB,KAAG,OAjBe;AAkBlB,MAAI,OAlBc;AAmBlB,MAAI,OAnBc;AAoBlB,MAAI,OApBc;AAsBlB,KAAG,KAtBe;AAuBlB,MAAI,KAvBc;AAwBlB,MAAI,KAxBc;AAyBlB,MAAI,KAzBc;AA0BlB,MAAI,KA1Bc;AA2BlB,MAAI,KA3Bc;AA6BlB,MAAI,UA7Bc;AA8BlB,MAAI,UA9Bc;AA+BlB,MAAI,UA/Bc;AAiClB,MAAI,WAjCc;AAkClB,MAAI,WAlCc;AAmClB,MAAI,WAnCc;AAoClB,MAAI,WApCc;AAqClB,MAAI,WArCc;AAsClB,MAAI,WAtCc;AAwClB,MAAI,WAxCc;AAyClB,MAAI,WAzCc;AA2ClB,MAAI,uBA3Cc;AA4ClB,MAAI,uBA5Cc;AA6ClB,MAAI,uBA7Cc;AA+ClB,MAAI,SA/Cc;AAgDlB,MAAI,SAhDc;AAkDlB,MAAI,OAlDc;AAoDlB,KAAG,aApDe;AAqDlB,KAAG,aArDe;AAuDlB,MAAI,sBAvDc;AAyDlB,MAAI,yBAzDc;AA2DlB,MAAI,wBA3Dc;AA6DlB,MAAI,uBA7Dc;AA+DlB,MAAI,oBA/Dc;AAiElB,MAAI,YAjEc;AAmElB,MAAI;AAnEc,CAAf;;AAsEA,IAAMC,KAAK,GAAG;AACjB,KAAE,aADe;AAEjB,MAAG,gBAFc;AAGjB,MAAG,uBAHc;AAIjB,MAAG,YAJc;AAKjB,MAAG,QALc;AAMjB,MAAG,UANc;AAOjB,MAAG,aAPc;AAQjB,MAAG,aARc;AASjB,MAAG,gBATc;AAUjB,MAAG,SAVc;AAWjB,MAAG,cAXc;AAYjB,MAAG,eAZc;AAajB,MAAG,uBAbc;AAcjB,KAAE,WAde;AAejB,MAAG,oBAfc;AAgBjB,MAAG,WAhBc;AAiBjB,MAAG,yBAjBc;AAkBjB,MAAG,sBAlBc;AAmBjB,MAAG,gBAnBc;AAoBjB,MAAG,WApBc;AAqBjB,MAAG,sBArBc;AAsBjB,MAAG,QAtBc;AAuBjB,MAAG,YAvBc;AAwBjB,MAAG,wBAxBc;AAyBjB,MAAG,oBAzBc;AA0BjB,MAAG,yBA1Bc;AA2BjB,MAAG,qBA3Bc;AA4BjB,KAAE,UA5Be;AA6BjB,KAAE,mBA7Be;AA8BjB,MAAG,SA9Bc;AA+BjB,MAAG,WA/Bc;AAgCjB,KAAE,uBAhCe;AAiCjB,MAAG,YAjCc;AAkCjB,KAAE,QAlCe;AAmCjB,MAAG,aAnCc;AAoCjB,MAAG,YApCc;AAqCjB,MAAG,aArCc;AAsCjB,KAAE,UAtCe;AAuCjB,MAAG,iBAvCc;AAwCjB,MAAG,OAxCc;AAyCjB,MAAG,uBAzCc;AA0CjB,KAAE,iBA1Ce;AA2CjB,KAAE,kBA3Ce;AA4CjB,MAAG,UA5Cc;AA6CjB,MAAG,eA7Cc;AA8CjB,MAAG,oBA9Cc;AA+CjB,MAAG;AA/Cc,CAAd;;;ACrHP;;AAEA;;;;;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA,CAAC,UAAUC,EAAV,EAAc;AACb,MAAIC,MAAM,GAAG;AACXC,IAAAA,GAAG,EAAE,EADM;AAEXC,IAAAA,KAAK,EAAE,EAFI;AAGXC,IAAAA,MAAM,EAAE,EAHG;AAIXC,IAAAA,IAAI,EAAE;AAJK,GAAb;AAOA,MAAIC,OAAJ,EAAaC,SAAb;AAEAC,EAAAA,SAAS;AAIT,MAAIC,IAAI,GAAG,EAAX;AACA,MAAIC,UAAU,GAAGZ,MAAM,CAACA,MAAxB;AACA,MAAIa,UAAU,GAAGb,MAAM,CAACD,MAAxB;;AAEA,WAASe,QAAT,CAAkBC,aAAlB,EAAiC;AAC/Bb,IAAAA,EAAE,CAACc,GAAH,CAAO,aAAP,EAAsBC,IAAtB,CAA2B,UAAChB,KAAD,EAAW;AAClC,UAAIiB,CAAC,GAAGC,SAAS,CAAChB,MAAD,CAAjB;AAEAiB,MAAAA,UAAU,CAACF,CAAD,CAAV;AACAG,MAAAA,iBAAiB,CAACH,CAAD,CAAjB;AAEAI,MAAAA,cAAc,CAACJ,CAAD,EAAIT,SAAS,CAACc,KAAd,EAAqBd,SAAS,CAACe,MAA/B,CAAd;AAEA,UAAIC,UAAU,GAAGC,eAAe,CAACzB,KAAD,EAAQW,UAAR,CAAhC;AACAD,MAAAA,IAAI,GAAGgB,UAAU,CAAC1B,KAAD,EAAQW,UAAR,EAAoB,IAApB,CAAjB;AAEA,UAAIgB,MAAM,GAAGC,SAAS,CAACpB,SAAS,CAACc,KAAX,EAAkBZ,IAAlB,CAAtB;AACA,UAAImB,MAAM,GAAGC,SAAS,CAACtB,SAAS,CAACe,MAAX,EAAmBb,IAAnB,EAAyBC,UAAzB,EAAoCG,aAApC,CAAtB;AACA,UAAIiB,UAAU,GAAGC,aAAa,CAACrB,UAAD,EAAaC,UAAb,CAA9B;AAEA,UAAIqB,UAAU,GAAGC,QAAQ,CAACvB,UAAD,EAAaa,UAAb,CAAzB;AAEA,UAAIW,WAAW,GAAGlC,EAAE,CAACmC,KAAH,GACbC,MADa,CACNpC,EAAE,CAACqC,qBADG,EAEbC,IAFa,CAERN,UAFQ,EAGbO,KAHa,CAGP,UAACC,CAAD,EAAGC,GAAH;AAAA,eAAWD,CAAC,CAACC,GAAD,CAAD,CAAO5B,aAAP,CAAX;AAAA,OAHO,EAIbJ,IAJa,CAAlB;AAMAiC,MAAAA,SAAS,CAAChB,MAAD,EAASnB,SAAS,CAACe,MAAnB,CAAT;AACAqB,MAAAA,SAAS,CAACf,MAAD,CAAT;AAEA,UAAIgB,IAAI,GAAG5C,EAAE,CAAC4C,IAAH,GACVC,CADU,CACR,UAASL,CAAT,EAAYM,CAAZ,EAAe;AAAE,eAAOpB,MAAM,CAACc,CAAC,CAAC/B,IAAF,CAAOsC,IAAR,CAAb;AAA6B,OADtC,EAEVC,EAFU,CAEP,UAASR,CAAT,EAAY;AAAE,eAAOZ,MAAM,CAACY,CAAC,CAAC,CAAD,CAAF,CAAb;AAAsB,OAF7B,EAGVS,EAHU,CAGP,UAAST,CAAT,EAAY;AAAE,eAAOZ,MAAM,CAACY,CAAC,CAAC,CAAD,CAAF,CAAb;AAAsB,OAH7B,CAAX;AAKA,UAAIU,OAAO,GAAGlC,CAAC,CACVmC,MADS,CACF,MADE,EAETC,IAFS,CAEJ,GAFI,EAEC,CAFD,EAGTA,IAHS,CAGJ,GAHI,EAGC,CAHD,EAITC,KAJS,CAIH,SAJG,EAIQ,CAJR,EAKTA,KALS,CAKH,WALG,EAKU,EALV,CAAd;;AAOA,UAAIC,SAAS,GAAG,SAAZA,SAAY,CAASd,CAAT,EAAY;AACxBU,QAAAA,OAAO,CAACG,KAAR,CAAc,SAAd,EAAyB,CAAzB;AACArD,QAAAA,EAAE,CAACuD,SAAH,CAAa,eAAb,EAA8BF,KAA9B,CAAoC,SAApC,EAA+C,EAA/C,EACKA,KADL,CACW,cADX,EAC2B,KAD3B;AAEArD,QAAAA,EAAE,CAACuD,SAAH,CAAa,eAAb,EACKC,MADL,CACY,UAAAC,CAAC;AAAA,iBAAI/C,UAAU,CAAC+C,CAAC,CAAChB,GAAH,CAAV,IAAqB/B,UAAU,CAAC8B,CAAC,CAACC,GAAH,CAAnC;AAAA,SADb,EAEKY,KAFL,CAEW,QAFX,EAEqB,OAFrB,EAGKA,KAHL,CAGW,SAHX,EAGsB,GAHtB;AAIArD,QAAAA,EAAE,CAAC0D,MAAH,CAAU,IAAV,EACKL,KADL,CACW,QADX,EACqB,OADrB,EAEKA,KAFL,CAEW,SAFX,EAEsB,CAFtB,EAGKA,KAHL,CAGW,cAHX,EAG2B,KAH3B;AAIH,OAZD;;AAaA,UAAIM,SAAS,GAAG,SAAZA,SAAY,CAASnB,CAAT,EAAWM,CAAX,EAAc;AAC1B;AACA,YAAIc,IAAI,GAAG,EAAX;;AACA,YAAIlD,UAAU,CAAC8B,CAAC,CAACC,GAAH,CAAV,IAAqB3C,MAAM,CAACC,KAAP,CAAayC,CAAC,CAACC,GAAf,CAAzB,EAA8C;AAC1CmB,UAAAA,IAAI,GAAGlD,UAAU,CAAC8B,CAAC,CAACC,GAAH,CAAV,GAAoB,IAApB,GAA2B3C,MAAM,CAACC,KAAP,CAAayC,CAAC,CAACC,GAAf,CAAlC;AACH,SAFD,MAEO;AACHmB,UAAAA,IAAI,GAAGlD,UAAU,CAAC8B,CAAC,CAACC,GAAH,CAAjB;AACH;;AAEDS,QAAAA,OAAO,CAACU,IAAR,CAAaA,IAAb;AACH,OAVD;;AAWA,UAAIC,UAAU,GAAG,SAAbA,UAAa,CAASrB,CAAT,EAAY;AACzBU,QAAAA,OAAO,CAACG,KAAR,CAAc,SAAd,EAAyB,CAAzB;AACArD,QAAAA,EAAE,CAACuD,SAAH,CAAa,eAAb,EAA8BF,KAA9B,CAAoC,SAApC,EAA+C,CAA/C,EAAkDA,KAAlD,CAAwD,QAAxD,EAAkE,MAAlE;AACH,OAHD;;AAKArC,MAAAA,CAAC,CACAuC,SADD,CACW,UADX,EAEC9C,IAFD,CAEMyB,WAFN,EAGC4B,KAHD,GAICX,MAJD,CAIQ,MAJR,EAKGC,IALH,CAKQ,OALR,EAKiB,QALjB,EAMGC,KANH,CAMS,MANT,EAMiB,UAASb,CAAT,EAAY;AAAE,eAAOV,UAAU,CAACU,CAAC,CAACC,GAAH,CAAjB;AAA2B,OAN1D,EAOGW,IAPH,CAOQ,GAPR,EAOYR,IAPZ,EAQGmB,EARH,CAQM,WARN,EAQmBT,SARnB,EASGS,EATH,CASM,WATN,EASmBJ,SATnB,EAUGI,EAVH,CAUM,YAVN,EAUoBF,UAVpB;AAWD,KA9EH;AA+ED;;AAEDjD,EAAAA,QAAQ,CAAC,OAAD,CAAR;AAEAoD,EAAAA,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCC,gBAAvC,CAAwD,OAAxD,EAAiEC,cAAjE;;AAEA,WAASA,cAAT,GAA0B;AACxB,QAAIC,MAAM,GAAGJ,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAAb;AACA,QAAII,QAAQ,GAAGD,MAAM,CAACE,YAAP,CAAoB,OAApB,CAAf;AAEAtE,IAAAA,EAAE,CAAC0D,MAAH,CAAU,OAAV,EAAmBH,SAAnB,CAA6B,GAA7B,EAAkCgB,MAAlC;;AAEA,QAAIF,QAAQ,IAAI,OAAhB,EAAwB;AACpBD,MAAAA,MAAM,CAACI,YAAP,CAAoB,OAApB,EAA6B,YAA7B;AACA5D,MAAAA,QAAQ,CAAC,YAAD,CAAR;AACAwD,MAAAA,MAAM,CAACK,SAAP,GAAmB,OAAnB;AACH,KAJD,MAIO;AACHL,MAAAA,MAAM,CAACI,YAAP,CAAoB,OAApB,EAA6B,OAA7B;AACA5D,MAAAA,QAAQ,CAAC,OAAD,CAAR;AACAwD,MAAAA,MAAM,CAACK,SAAP,GAAmB,YAAnB;AACH;AACF;AAED;;;;;AAGC,WAASjE,SAAT,GAAsB;AACrB,QAAIkE,UAAU,GAAGC,IAAI,CAACC,GAAL,CAASC,IAAI,CAACC,UAAd,EAA0B,IAA1B,CAAjB;AACA,QAAIC,WAAW,GAAGL,UAAU,GAAG,GAA/B;AAEApE,IAAAA,OAAO,GAAG;AACRe,MAAAA,KAAK,EAAEqD,UADC;AAERpD,MAAAA,MAAM,EAAEyD;AAFA,KAAV;AAKAxE,IAAAA,SAAS,GAAG;AACVc,MAAAA,KAAK,EAAEf,OAAO,CAACe,KAAR,GAAgBpB,MAAM,CAACE,KAAvB,GAA+BF,MAAM,CAACI,IADnC;AAEViB,MAAAA,MAAM,EAAEhB,OAAO,CAACgB,MAAR,GAAiBrB,MAAM,CAACG,MAAxB,GAAiCH,MAAM,CAACC;AAFtC,KAAZ;AAKA8E,IAAAA,aAAa,CAAC1E,OAAO,CAACe,KAAT,EAAgBf,OAAO,CAACgB,MAAxB,CAAb;AACD;AACF,CA5ID,EA4IGtB,EA5IH;;AA8IE,SAASyB,UAAT,CAAoB1B,KAApB,EAA2BD,MAA3B,EAAmD;AAAA,MAAhBmF,SAAgB,uEAAN,IAAM;AAC/C,MAAIxE,IAAI,GAAG,EAAX;AACA,MAAIyE,WAAW,GAAG,EAAlB;AACAC,EAAAA,MAAM,CAAC7C,IAAP,CAAYxC,MAAZ,EAAoBsF,OAApB,CAA4B,UAAA3C,GAAG,EAAG;AAC9ByC,IAAAA,WAAW,CAACzC,GAAD,CAAX,GAAmB,CAAnB;AACH,GAFD;AAIA,MAAI4C,QAAQ,GAAG,IAAIC,IAAJ,GAAWC,WAAX,EAAf;AACA,MAAIC,SAAS,GAAKH,QAAQ,GAAE,CAAX,GAAgB,CAACA,QAAQ,GAAE,CAAX,IAAgB,CAAjC,GAAsC,CAAtD;AAEAtF,EAAAA,KAAK,CAACqF,OAAN,CAAc,UAAAK,OAAO,EAAI;AACrB,QAAIC,MAAM,GAAGC,QAAQ,CAACF,OAAO,CAACG,IAAR,CAAaC,MAAb,CAAoB,EAApB,CAAD,CAArB;AACA,QAAI9C,IAAI,GAAG0C,OAAO,CAAC1C,IAAR,GAAe0C,OAAO,CAAC1C,IAAR,GAAe,CAAzC;;AACA,QAAIA,IAAI,IAAIyC,SAAZ,EAAuB;AACrB,UAAI,CAAC/E,IAAI,CAACqF,IAAL,CAAU,UAAAtD,CAAC;AAAA,eAAIA,CAAC,CAACO,IAAF,IAAUA,IAAd;AAAA,OAAX,CAAL,EAAoC;AAChC,YAAIgD,GAAG,GAAG;AAAC,kBAAOhD;AAAR,SAAV;AACAoC,QAAAA,MAAM,CAAC7C,IAAP,CAAYxC,MAAZ,EAAoBsF,OAApB,CAA4B,UAAA3C,GAAG,EAAG;AAChCsD,UAAAA,GAAG,CAACtD,GAAD,CAAH,GAAW,CAAX;AACD,SAFD;AAGAhC,QAAAA,IAAI,CAACuF,IAAL,CAAUD,GAAV;AACH;;AAEDtF,MAAAA,IAAI,CAACqF,IAAL,CAAU,UAAAtD,CAAC;AAAA,eAAIA,CAAC,CAACO,IAAF,IAAUA,IAAd;AAAA,OAAX,EAA+B2C,MAA/B,IAAyCC,QAAQ,CAACF,OAAO,CAACQ,KAAT,CAAjD;AACD;AACJ,GAdD;;AAeA,MAAIhB,SAAJ,EAAe;AACXxE,IAAAA,IAAI,CAAC2E,OAAL,CAAa,UAAA5C,CAAC,EAAI;AACd,UAAI0D,OAAO,GAAG,CAAd;AACAf,MAAAA,MAAM,CAAC7C,IAAP,CAAYxC,MAAZ,EAAoBsF,OAApB,CAA4B,UAAApE,CAAC,EAAI;AAC/BkF,QAAAA,OAAO,IAAI1D,CAAC,CAACxB,CAAD,CAAZ;AACD,OAFD;AAGAmE,MAAAA,MAAM,CAAC7C,IAAP,CAAYxC,MAAZ,EAAoBsF,OAApB,CAA4B,UAAApE,CAAC,EAAI;AAC/BwB,QAAAA,CAAC,CAACxB,CAAD,CAAD,GAAO;AAAC,mBAAQwB,CAAC,CAACxB,CAAD,CAAV;AAAe,wBAAawB,CAAC,CAACxB,CAAD,CAAD,GAAKkF;AAAjC,SAAP;AACD,OAFD;AAGH,KARD;AASH;;AACD,SAAOzF,IAAP;AACH;;AAED,SAASkB,SAAT,CAAoBN,KAApB,EAA2BZ,IAA3B,EAAiC;AAClC,SAAOT,EAAE,CAACmG,WAAH,GACJC,MADI,CACGpG,EAAE,CAACqG,MAAH,CAAU5F,IAAV,EAAgB,UAAS+B,CAAT,EAAY;AAAE,WAAOA,CAAC,CAACO,IAAT;AAAgB,GAA9C,CADH,EAEJuD,KAFI,CAEE,CAAC,CAAD,EAAIjF,KAAJ,CAFF,CAAP;AAGA;;AAED,SAASQ,SAAT,CAAoBP,MAApB,EAA4Bb,IAA5B,EAAkCC,UAAlC,EAA8CG,aAA9C,EAA6D;AAC5D;AACA,MAAIyF,KAAK,GAAG,CAAZ;AAEG7F,EAAAA,IAAI,CAAC2E,OAAL,CAAa,UAAA5C,CAAC,EAAI;AACd,QAAI+D,QAAQ,GAAG,CAAf;AACApB,IAAAA,MAAM,CAAC7C,IAAP,CAAY5B,UAAZ,EAAwB0E,OAAxB,CAAgC,UAAA3C,GAAG,EAAI;AACnC,UAAID,CAAC,CAACC,GAAD,CAAD,CAAO5B,aAAP,CAAJ,EAA0B;AACtB0F,QAAAA,QAAQ,IAAI/D,CAAC,CAACC,GAAD,CAAD,CAAO5B,aAAP,CAAZ;AACH;AACJ,KAJD;;AAKA,QAAI0F,QAAQ,GAAGD,KAAf,EAAqB;AACjBA,MAAAA,KAAK,GAAGC,QAAR;AACH;AACJ,GAVD;AAYH,SAAOvG,EAAE,CAACmG,WAAH,GACCC,MADD,CACQ,CAAC,CAAC,CAAD,GAAKE,KAAL,GAAa,CAAd,EAAiBA,KAAK,GAAG,CAAzB,CADR,EAECA,KAFD,CAEO,CAAEhF,MAAF,EAAU,CAAV,CAFP,CAAP;AAGA;;AAED,SAASS,aAAT,CAAwBrB,UAAxB,EAAoC8F,YAApC,EAAkD;AAC9C,MAAIJ,MAAM,GAAG,EAAb;AACA,MAAIvG,MAAM,GAAG,EAAb;AACAsF,EAAAA,MAAM,CAACsB,OAAP,CAAe/F,UAAf,EAA2B0E,OAA3B,CAAmC,UAAAsB,CAAC,EAAI;AACpCN,IAAAA,MAAM,CAACJ,IAAP,CAAYU,CAAC,CAAC,CAAD,CAAb;AACA7G,IAAAA,MAAM,CAACmG,IAAP,CAAYQ,YAAY,CAACE,CAAC,CAAC,CAAD,CAAF,CAAxB;AACH,GAHD;AAIA,SAAO1G,EAAE,CAAC2G,YAAH,GACFP,MADE,CACKA,MADL,EAEFE,KAFE,CAEIzG,MAFJ,CAAP;AAGH;AAED;;;;;;;;AAMA,SAAS6C,SAAT,CAAoBhB,MAApB,EAA4BJ,MAA5B,EAAoC;AAChCtB,EAAAA,EAAE,CAAC0D,MAAH,CAAU,eAAV,EACGN,IADH,CACQ,WADR,EACqB,mBAAmB9B,MAAnB,GAA4B,GADjD,EAEGsF,IAFH,CAEQ5G,EAAE,CAAC6G,UAAH,CAAcnF,MAAd,EAAsBoF,aAAtB,CAAoC,CAApC,EAAuCC,UAAvC,CAAkD/G,EAAE,CAACgH,MAAH,CAAU,GAAV,CAAlD,CAFR,EADgC,CAG0C;AAC3E;AAED;;;;;;;AAKF,SAASrE,SAAT,CAAoBf,MAApB,EAA4B;AACxB5B,EAAAA,EAAE,CAAC0D,MAAH,CAAU,eAAV,EACGkD,IADH,CACQ5G,EAAE,CAACiH,QAAH,CAAYrF,MAAZ,EAAoBkF,aAApB,CAAkC,CAAlC,EAAqCI,aAArC,CAAmD,CAAC,CAAD,EAAI,KAAJ,CAAnD,CADR;AAED;;AAEH,SAAS1F,eAAT,CAAyBf,IAAzB,EAA+BX,MAA/B,EAAsC;AAClC,MAAIqH,WAAW,GAAG,EAAlB;AACA1G,EAAAA,IAAI,CAAC2E,OAAL,CAAa,UAAA5C,CAAC,EAAI;AACd,QAAIkD,MAAM,GAAGC,QAAQ,CAACnD,CAAC,CAACoD,IAAF,CAAOC,MAAP,CAAc,EAAd,CAAD,CAArB;;AACA,QAAI,CAACsB,WAAW,CAACrH,MAAM,CAAC4F,MAAD,CAAP,CAAhB,EAAkC;AAC9ByB,MAAAA,WAAW,CAACrH,MAAM,CAAC4F,MAAD,CAAP,CAAX,GAA8B,CAA9B;AACH;;AACDyB,IAAAA,WAAW,CAACrH,MAAM,CAAC4F,MAAD,CAAP,CAAX,IAA+BC,QAAQ,CAACnD,CAAC,CAACyD,KAAH,CAAvC;AACH,GAND;AAQA,SAAOd,MAAM,CAACsB,OAAP,CAAeU,WAAf,EAA4BC,IAA5B,CAAiC,UAAC3D,CAAD,EAAG4D,CAAH;AAAA,WAASA,CAAC,CAAC,CAAD,CAAD,GAAO5D,CAAC,CAAC,CAAD,CAAjB;AAAA,GAAjC,EAAuD6D,GAAvD,CAA2D,UAAAC,CAAC;AAAA,WAAIA,CAAC,CAAC,CAAD,CAAL;AAAA,GAA5D,CAAP;AACH;;AAED,SAAStF,QAAT,CAAkBlC,KAAlB,EAAyByH,KAAzB,EAA+B;AAC3B,MAAIxF,UAAU,GAAGmD,MAAM,CAACsB,OAAP,CAAe1G,KAAf,EAAsBqH,IAAtB,CAA2B,UAAC3D,CAAD,EAAG4D,CAAH,EAAS;AACjD,QAAII,MAAM,GAAGD,KAAK,CAACE,SAAN,CAAgB,UAAAhB,CAAC;AAAA,aAAIA,CAAC,IAAIjD,CAAC,CAAC,CAAD,CAAV;AAAA,KAAjB,CAAb;AACA,QAAIkE,MAAM,GAAGH,KAAK,CAACE,SAAN,CAAgB,UAAAhB,CAAC;AAAA,aAAIA,CAAC,IAAIW,CAAC,CAAC,CAAD,CAAV;AAAA,KAAjB,CAAb;;AACA,QAAGI,MAAM,GAAGE,MAAZ,EAAoB;AAAE,aAAO,CAAC,CAAR;AAAY;;AAClC,QAAGF,MAAM,GAAGE,MAAZ,EAAoB;AAAE,aAAO,CAAP;AAAW;;AACjC,WAAO,CAAP;AACH,GANgB,EAMdL,GANc,CAMV,UAAAC,CAAC;AAAA,WAAIA,CAAC,CAAC,CAAD,CAAL;AAAA,GANS,CAAjB;AAOA,SAAOvF,UAAP;AACH;;AAED,SAASd,UAAT,CAAqBF,CAArB,EAAwB;AACpBA,EAAAA,CAAC,CAACmC,MAAF,CAAS,GAAT,EACCC,IADD,CACM,OADN,EACe,QADf;AAEH;;AAED,SAASjC,iBAAT,CAA4BH,CAA5B,EAA+B;AAC3BA,EAAAA,CAAC,CAACmC,MAAF,CAAS,MAAT,EACKS,IADL,CACU,OADV,EAEKR,IAFL,CAEU,OAFV,EAEmB,aAFnB,EAGKA,IAHL,CAGU,WAHV,EAGuB,EAHvB;AAIH;;AAED,SAAShC,cAAT,CAAyBJ,CAAzB,EAA4BK,KAA5B,EAAmCC,MAAnC,EAA2C;AACvC;AACEtB,EAAAA,EAAE,CAAC0D,MAAH,CAAU,oBAAV,EACKN,IADL,CACU,GADV,EACe,CAAC,EADhB,EAEKA,IAFL,CAEU,GAFV,EAEe9B,MAAM,GAAG,CAFxB;AAIAtB,EAAAA,EAAE,CAAC0D,MAAH,CAAU,oBAAV,EACKN,IADL,CACU,GADV,EACe/B,KAAK,GAAG,CADvB,EAEK+B,IAFL,CAEU,GAFV,EAEe9B,MAAM,GAAC,EAFtB;AAGH;;AAEF,SAASL,SAAT,CAAoBhB,MAApB,EAA4B;AACzB,SAAOD,EAAE,CAAC0D,MAAH,CAAU,aAAV,EACJA,MADI,CACG,KADH,EAEJP,MAFI,CAEG,GAFH,EAGJC,IAHI,CAGC,IAHD,EAGO,SAHP,EAIJA,IAJI,CAIC,WAJD,EAKH,eAAenD,MAAM,CAACI,IAAtB,GAA6B,GAA7B,GAAmCJ,MAAM,CAACC,GAA1C,GAAgD,GAL7C,CAAP;AAMD;;AAED,SAAS8E,aAAT,CAAwB3D,KAAxB,EAA+BC,MAA/B,EAAuC;AACrCtB,EAAAA,EAAE,CAAC0D,MAAH,CAAU,OAAV,EACGN,IADH,CACQ,OADR,EACiB/B,KADjB,EAEG+B,IAFH,CAEQ,QAFR,EAEkB9B,MAFlB;AAGD;;;ACpVH,IAAIsG,UAAU,GAAG,4BAAjB;AAEA,IAAIC,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAcC,MAA9B;;AAEA,SAASA,MAAT,CAAgBC,UAAhB,EAA4B;AAC1BJ,EAAAA,SAAS,CAACjB,IAAV,CAAe,IAAf,EAAqBqB,UAArB;AACA,OAAKC,GAAL,GAAW;AACTzH,IAAAA,IAAI,EAAEqH,MAAM,CAACC,MAAP,CAAcI,OADX;AAETC,IAAAA,gBAAgB,EAAE,EAFT;AAGTC,IAAAA,iBAAiB,EAAE,EAHV;AAITC,IAAAA,MAAM,EAAE,UAAUC,EAAV,EAAc;AACpB,WAAKH,gBAAL,CAAsBpC,IAAtB,CAA2BuC,EAAE,IAAI,YAAY,CAAE,CAA/C;AACD,KANQ;AAOTC,IAAAA,OAAO,EAAE,UAAUD,EAAV,EAAc;AACrB,WAAKF,iBAAL,CAAuBrC,IAAvB,CAA4BuC,EAA5B;AACD;AATQ,GAAX;AAYAT,EAAAA,MAAM,CAACC,MAAP,CAAcI,OAAd,GAAwB,IAAxB;AACD;;AAEDL,MAAM,CAACC,MAAP,CAAcC,MAAd,GAAuBA,MAAvB;AACA,IAAIS,aAAJ,EAAmBC,cAAnB;AAEA,IAAIC,MAAM,GAAGb,MAAM,CAACC,MAAP,CAAcY,MAA3B;;AACA,IAAI,CAAC,CAACA,MAAD,IAAW,CAACA,MAAM,CAACC,eAApB,KAAwC,OAAOC,SAAP,KAAqB,WAAjE,EAA8E;AAC5E,MAAIC,QAAQ,GAAG,MAA4BC,QAAQ,CAACD,QAApD;AACA,MAAIE,QAAQ,GAAGD,QAAQ,CAACC,QAAT,KAAsB,QAAtB,GAAiC,KAAjC,GAAyC,IAAxD;AACA,MAAIC,EAAE,GAAG,IAAIJ,SAAJ,CAAcG,QAAQ,GAAG,KAAX,GAAmBF,QAAnB,GAA8B,GAA9B,aAA2D,GAAzE,CAAT;;AACAG,EAAAA,EAAE,CAACC,SAAH,GAAe,UAASC,KAAT,EAAgB;AAC7BV,IAAAA,aAAa,GAAG,EAAhB;AACAC,IAAAA,cAAc,GAAG,EAAjB;AAEA,QAAIjI,IAAI,GAAG2I,IAAI,CAACC,KAAL,CAAWF,KAAK,CAAC1I,IAAjB,CAAX;;AAEA,QAAIA,IAAI,CAAC6I,IAAL,KAAc,QAAlB,EAA4B;AAC1B,UAAIC,OAAO,GAAG,KAAd;AACA9I,MAAAA,IAAI,CAAC+I,MAAL,CAAYpE,OAAZ,CAAoB,UAASqE,KAAT,EAAgB;AAClC,YAAI,CAACA,KAAK,CAACC,KAAX,EAAkB;AAChB,cAAIC,SAAS,GAAGC,cAAc,CAACC,MAAM,CAACC,aAAR,EAAuBL,KAAK,CAACM,EAA7B,CAA9B;;AACA,cAAIJ,SAAJ,EAAe;AACbJ,YAAAA,OAAO,GAAG,IAAV;AACD;AACF;AACF,OAPD,EAF0B,CAW1B;;AACAA,MAAAA,OAAO,GAAGA,OAAO,IAAI9I,IAAI,CAAC+I,MAAL,CAAYQ,KAAZ,CAAkB,UAASP,KAAT,EAAgB;AACrD,eAAOA,KAAK,CAACH,IAAN,KAAe,KAAf,IAAwBG,KAAK,CAACQ,SAAN,CAAgBC,EAA/C;AACD,OAFoB,CAArB;;AAIA,UAAIX,OAAJ,EAAa;AACXY,QAAAA,OAAO,CAACC,KAAR;AAEA3J,QAAAA,IAAI,CAAC+I,MAAL,CAAYpE,OAAZ,CAAoB,UAAUqE,KAAV,EAAiB;AACnCY,UAAAA,QAAQ,CAACR,MAAM,CAACC,aAAR,EAAuBL,KAAvB,CAAR;AACD,SAFD;AAIAf,QAAAA,cAAc,CAACtD,OAAf,CAAuB,UAAUkF,CAAV,EAAa;AAClCC,UAAAA,YAAY,CAACD,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,CAAZ;AACD,SAFD;AAGD,OAVD,MAUO,IAAIvB,QAAQ,CAACyB,MAAb,EAAqB;AAAE;AAC5BzB,QAAAA,QAAQ,CAACyB,MAAT;AACD;AACF;;AAED,QAAI/J,IAAI,CAAC6I,IAAL,KAAc,QAAlB,EAA4B;AAC1BL,MAAAA,EAAE,CAACwB,KAAH;;AACAxB,MAAAA,EAAE,CAACyB,OAAH,GAAa,YAAY;AACvB3B,QAAAA,QAAQ,CAACyB,MAAT;AACD,OAFD;AAGD;;AAED,QAAI/J,IAAI,CAAC6I,IAAL,KAAc,gBAAlB,EAAoC;AAClCa,MAAAA,OAAO,CAACQ,GAAR,CAAY,2BAAZ;AAEAC,MAAAA,kBAAkB;AACnB;;AAED,QAAInK,IAAI,CAAC6I,IAAL,KAAc,OAAlB,EAA2B;AACzBa,MAAAA,OAAO,CAACU,KAAR,CAAc,kBAAkBpK,IAAI,CAACoK,KAAL,CAAWC,OAA7B,GAAuC,IAAvC,GAA8CrK,IAAI,CAACoK,KAAL,CAAW1I,KAAvE;AAEAyI,MAAAA,kBAAkB;AAElB,UAAIG,OAAO,GAAGC,kBAAkB,CAACvK,IAAD,CAAhC;AACAuD,MAAAA,QAAQ,CAACiH,IAAT,CAAcC,WAAd,CAA0BH,OAA1B;AACD;AACF,GA1DD;AA2DD;;AAED,SAASH,kBAAT,GAA8B;AAC5B,MAAIG,OAAO,GAAG/G,QAAQ,CAACC,cAAT,CAAwB2D,UAAxB,CAAd;;AACA,MAAImD,OAAJ,EAAa;AACXA,IAAAA,OAAO,CAACxG,MAAR;AACD;AACF;;AAED,SAASyG,kBAAT,CAA4BvK,IAA5B,EAAkC;AAChC,MAAIsK,OAAO,GAAG/G,QAAQ,CAACmH,aAAT,CAAuB,KAAvB,CAAd;AACAJ,EAAAA,OAAO,CAAChB,EAAR,GAAanC,UAAb,CAFgC,CAIhC;;AACA,MAAIkD,OAAO,GAAG9G,QAAQ,CAACmH,aAAT,CAAuB,KAAvB,CAAd;AACA,MAAIC,UAAU,GAAGpH,QAAQ,CAACmH,aAAT,CAAuB,KAAvB,CAAjB;AACAL,EAAAA,OAAO,CAACO,SAAR,GAAoB5K,IAAI,CAACoK,KAAL,CAAWC,OAA/B;AACAM,EAAAA,UAAU,CAACC,SAAX,GAAuB5K,IAAI,CAACoK,KAAL,CAAW1I,KAAlC;AAEA4I,EAAAA,OAAO,CAACtG,SAAR,GACE,2NACE,mFADF,GAEE,yEAFF,GAGE,qEAHF,GAG0EqG,OAAO,CAACrG,SAHlF,GAG8F,QAH9F,GAIE,OAJF,GAIY2G,UAAU,CAAC3G,SAJvB,GAImC,QAJnC,GAKA,QANF;AASA,SAAOsG,OAAP;AAED;;AAED,SAASO,UAAT,CAAoBvD,MAApB,EAA4BgC,EAA5B,EAAgC;AAC9B,MAAIwB,OAAO,GAAGxD,MAAM,CAACwD,OAArB;;AACA,MAAI,CAACA,OAAL,EAAc;AACZ,WAAO,EAAP;AACD;;AAED,MAAIC,OAAO,GAAG,EAAd;AACA,MAAIC,CAAJ,EAAOjJ,CAAP,EAAUkJ,GAAV;;AAEA,OAAKD,CAAL,IAAUF,OAAV,EAAmB;AACjB,SAAK/I,CAAL,IAAU+I,OAAO,CAACE,CAAD,CAAP,CAAW,CAAX,CAAV,EAAyB;AACvBC,MAAAA,GAAG,GAAGH,OAAO,CAACE,CAAD,CAAP,CAAW,CAAX,EAAcjJ,CAAd,CAAN;;AACA,UAAIkJ,GAAG,KAAK3B,EAAR,IAAe4B,KAAK,CAACC,OAAN,CAAcF,GAAd,KAAsBA,GAAG,CAACA,GAAG,CAACG,MAAJ,GAAa,CAAd,CAAH,KAAwB9B,EAAjE,EAAsE;AACpEyB,QAAAA,OAAO,CAACxF,IAAR,CAAayF,CAAb;AACD;AACF;AACF;;AAED,MAAI1D,MAAM,CAACY,MAAX,EAAmB;AACjB6C,IAAAA,OAAO,GAAGA,OAAO,CAACM,MAAR,CAAeR,UAAU,CAACvD,MAAM,CAACY,MAAR,EAAgBoB,EAAhB,CAAzB,CAAV;AACD;;AAED,SAAOyB,OAAP;AACD;;AAED,SAASnB,QAAT,CAAkBtC,MAAlB,EAA0B0B,KAA1B,EAAiC;AAC/B,MAAI8B,OAAO,GAAGxD,MAAM,CAACwD,OAArB;;AACA,MAAI,CAACA,OAAL,EAAc;AACZ;AACD;;AAED,MAAIA,OAAO,CAAC9B,KAAK,CAACM,EAAP,CAAP,IAAqB,CAAChC,MAAM,CAACY,MAAjC,EAAyC;AACvC,QAAIJ,EAAE,GAAG,IAAIwD,QAAJ,CAAa,SAAb,EAAwB,QAAxB,EAAkC,SAAlC,EAA6CtC,KAAK,CAACQ,SAAN,CAAgBC,EAA7D,CAAT;AACAT,IAAAA,KAAK,CAACC,KAAN,GAAc,CAAC6B,OAAO,CAAC9B,KAAK,CAACM,EAAP,CAAtB;AACAwB,IAAAA,OAAO,CAAC9B,KAAK,CAACM,EAAP,CAAP,GAAoB,CAACxB,EAAD,EAAKkB,KAAK,CAACuC,IAAX,CAApB;AACD,GAJD,MAIO,IAAIjE,MAAM,CAACY,MAAX,EAAmB;AACxB0B,IAAAA,QAAQ,CAACtC,MAAM,CAACY,MAAR,EAAgBc,KAAhB,CAAR;AACD;AACF;;AAED,SAASG,cAAT,CAAwB7B,MAAxB,EAAgCgC,EAAhC,EAAoC;AAClC,MAAIwB,OAAO,GAAGxD,MAAM,CAACwD,OAArB;;AACA,MAAI,CAACA,OAAL,EAAc;AACZ;AACD;;AAED,MAAI,CAACA,OAAO,CAACxB,EAAD,CAAR,IAAgBhC,MAAM,CAACY,MAA3B,EAAmC;AACjC,WAAOiB,cAAc,CAAC7B,MAAM,CAACY,MAAR,EAAgBoB,EAAhB,CAArB;AACD;;AAED,MAAItB,aAAa,CAACsB,EAAD,CAAjB,EAAuB;AACrB;AACD;;AACDtB,EAAAA,aAAa,CAACsB,EAAD,CAAb,GAAoB,IAApB;AAEA,MAAIkC,MAAM,GAAGlE,MAAM,CAACmE,KAAP,CAAanC,EAAb,CAAb;AAEArB,EAAAA,cAAc,CAAC1C,IAAf,CAAoB,CAAC+B,MAAD,EAASgC,EAAT,CAApB;;AAEA,MAAIkC,MAAM,IAAIA,MAAM,CAAC/D,GAAjB,IAAwB+D,MAAM,CAAC/D,GAAP,CAAWE,gBAAX,CAA4ByD,MAAxD,EAAgE;AAC9D,WAAO,IAAP;AACD;;AAED,SAAOP,UAAU,CAACzB,MAAM,CAACC,aAAR,EAAuBC,EAAvB,CAAV,CAAqCoC,IAArC,CAA0C,UAAUpC,EAAV,EAAc;AAC7D,WAAOH,cAAc,CAACC,MAAM,CAACC,aAAR,EAAuBC,EAAvB,CAArB;AACD,GAFM,CAAP;AAGD;;AAED,SAASQ,YAAT,CAAsBxC,MAAtB,EAA8BgC,EAA9B,EAAkC;AAChC,MAAIkC,MAAM,GAAGlE,MAAM,CAACmE,KAAP,CAAanC,EAAb,CAAb;AACAhC,EAAAA,MAAM,CAACI,OAAP,GAAiB,EAAjB;;AACA,MAAI8D,MAAJ,EAAY;AACVA,IAAAA,MAAM,CAAC/D,GAAP,CAAWzH,IAAX,GAAkBsH,MAAM,CAACI,OAAzB;AACD;;AAED,MAAI8D,MAAM,IAAIA,MAAM,CAAC/D,GAAjB,IAAwB+D,MAAM,CAAC/D,GAAP,CAAWG,iBAAX,CAA6BwD,MAAzD,EAAiE;AAC/DI,IAAAA,MAAM,CAAC/D,GAAP,CAAWG,iBAAX,CAA6BjD,OAA7B,CAAqC,UAAUgH,EAAV,EAAc;AACjDA,MAAAA,EAAE,CAACrE,MAAM,CAACI,OAAR,CAAF;AACD,KAFD;AAGD;;AAED,SAAOJ,MAAM,CAACmE,KAAP,CAAanC,EAAb,CAAP;AACAhC,EAAAA,MAAM,CAACgC,EAAD,CAAN;AAEAkC,EAAAA,MAAM,GAAGlE,MAAM,CAACmE,KAAP,CAAanC,EAAb,CAAT;;AACA,MAAIkC,MAAM,IAAIA,MAAM,CAAC/D,GAAjB,IAAwB+D,MAAM,CAAC/D,GAAP,CAAWE,gBAAX,CAA4ByD,MAAxD,EAAgE;AAC9DI,IAAAA,MAAM,CAAC/D,GAAP,CAAWE,gBAAX,CAA4BhD,OAA5B,CAAoC,UAAUgH,EAAV,EAAc;AAChDA,MAAAA,EAAE;AACH,KAFD;;AAGA,WAAO,IAAP;AACD;AACF","file":"viz3.112b2779.js","sourceRoot":"..","sourcesContent":["/*\r\n#00876c\r\n#2c9470\r\n#45a074\r\n#5cad78\r\n#72b97c\r\n#88c580\r\n#9fd184\r\n#b6dd89\r\n#cee98f\r\n#e6f495\r\n#ffff9d\r\n#ffed8a\r\n#fedb79\r\n#fcc86b\r\n#fab560\r\n#f7a258\r\n#f38f52\r\n#ed7b4f\r\n#e7674e\r\n#de534f\r\n#d43d51\r\n*/\r\n\r\nexport const colors = {\r\n    'Acteur':'#8fda59',\r\n    'Production':'#42952e',\r\n    'Technique':'#b3b3b3',\r\n    'Esthetique':'#bfcd8e',\r\n    'Image':'#4cf32c',\r\n    'Son':'#eb46ea',\r\n    'Scénario':'#713d83',\r\n    'Organisme':'#8115b4',\r\n    'Narration':'#e9d737',\r\n    'Documentaire/émission':'#b3b3b3',\r\n    'Science':'#b3b3b3',\r\n    'Régie':'#b3b3b3',\r\n    'Réalisation':'#35618f',\r\n    'Direction artistique':'#9e7ee9',\r\n    'Direction de production':'#34debb',\r\n    'Photographe de plateau':'#da2d82',\r\n    'Générique additionnel':'#828282',\r\n    'Maison de services':'#b3b3b3',\r\n    'Conception':'#b3b3b3',\r\n    'Création':'#b3b3b3'\r\n}\r\n\r\nexport const groups = {\r\n    24: 'Acteur',\r\n    25: 'Acteur',\r\n    15: 'Acteur',\r\n\r\n    28: 'Production',\r\n    29: 'Production',\r\n    48: 'Production',\r\n\r\n    4: 'Technique',\r\n    5: 'Technique',\r\n\r\n    6: 'Esthetique',\r\n    8: 'Esthetique',\r\n    9: 'Esthetique',\r\n    17: 'Esthetique',\r\n\r\n    2: 'Image',\r\n    12: 'Image',\r\n    14: 'Image',\r\n    19: 'Image',\r\n\r\n    7: 'Son',\r\n    18: 'Son',\r\n    20: 'Son',\r\n    27: 'Son',\r\n    16: 'Son',\r\n    21: 'Son',\r\n\r\n    31: 'Scénario',\r\n    32: 'Scénario',\r\n    33: 'Scénario',\r\n\r\n    34: 'Organisme',\r\n    39: 'Organisme',\r\n    40: 'Organisme',\r\n    43: 'Organisme',\r\n    49: 'Organisme',\r\n    37: 'Organisme',\r\n\r\n    22: 'Narration',\r\n    23: 'Narration',\r\n\r\n    35: 'Documentaire/émission',\r\n    36: 'Documentaire/émission',\r\n    47: 'Documentaire/émission',\r\n\r\n    38: 'Science',\r\n    41: 'Science',\r\n\r\n    30: 'Régie',\r\n\r\n    3: 'Réalisation',\r\n    1: 'Réalisation',\r\n\r\n    10: 'Direction artistique',\r\n\r\n    11: 'Direction de production',\r\n\r\n    26: 'Photographe de plateau',\r\n\r\n    13: 'Générique additionnel',\r\n\r\n    42: 'Maison de services',\r\n\r\n    44: 'Conception',\r\n\r\n    45: 'Création'\r\n}\r\n\r\nexport const roles = {\r\n    1:\"Réalisation\",\r\n    15:\"Interprétation\",\r\n    34:\"Société de production\",\r\n    28:\"Producteur\",\r\n    14:\"Images\",\r\n    31:\"Scénario\",\r\n    37:\"Financement\",\r\n    24:\"Participant\",\r\n    19:\"Montage images\",\r\n    21:\"Musique\",\r\n    27:\"Prise de son\",\r\n    43:\"Télédiffuseur\",\r\n    13:\"Générique additionnel\",\r\n    2:\"Animation\",\r\n    29:\"Producteur délégué\",\r\n    38:\"Recherche\",\r\n    39:\"Société de distribution\",\r\n    10:\"Direction artistique\",\r\n    20:\"Montage sonore\",\r\n    23:\"Narrateur\",\r\n    35:\"Animateur d'émission\",\r\n    18:\"Mixage\",\r\n    25:\"Personnage\",\r\n    26:\"Photographe de plateau\",\r\n    16:\"Interprète musique\",\r\n    11:\"Direction de production\",\r\n    48:\"Producteur exécutif\",\r\n    8:\"Costumes\",\r\n    7:\"Conception sonore\",\r\n    32:\"Scripte\",\r\n    22:\"Narration\",\r\n    3:\"Assistant réalisation\",\r\n    17:\"Maquillage\",\r\n    9:\"Décors\",\r\n    36:\"Journaliste\",\r\n    44:\"Conception\",\r\n    47:\"Chroniqueur\",\r\n    6:\"Coiffure\",\r\n    12:\"Effets spéciaux\",\r\n    30:\"Régie\",\r\n    40:\"Société d'exportation\",\r\n    5:\"Chef machiniste\",\r\n    4:\"Chef électricien\",\r\n    45:\"Création\",\r\n    49:\"Diffuseur Web\",\r\n    42:\"Maison de services\",\r\n    41:\"Laboratoire\"\r\n}\r\n","'use strict'\r\n\r\nimport * as groups from './groups.js'\r\n\r\n/*\r\nBASE <http://data.cinematheque.qc.ca>\r\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\r\nPREFIX frbroo: <http://iflastandards.info/ns/fr/frbr/frbroo/>\r\nPREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>\r\nPREFIX owl: <http://www.w3.org/2002/07/owl#>\r\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\r\nPREFIX wd: <http://www.wikidata.org/entity/>\r\n\r\nSELECT ?role ?roleLabel ?year (count(?role) as ?count) WHERE {\r\n  ?publicProjectionEvent crm:P16_used_specific_object ?publicationExpression .\r\n  ?publicationExpression crm:P165_incorporates ?recording .\r\n  ?recordingEvent frbroo:R21_created ?recording .\r\n  ?recordingEvent crm:P9_consists_of ?recordingActivity .\r\n  ?recordingEvent frbroo:R22_created_a_realization_of ?recordingWork .\r\n  ?recordingWork frbroo:R2_is_derivative_of ?work .\r\n  ?work crm:P102_has_title ?workTitle .\r\n  FILTER (contains(str(?work), \"http://data.cinematheque.qc.ca\") && contains(str(?workTitle),\"OriginalTitleWork\"))\r\n  ?recordingActivityCarriedOutBy crm:P01_has_domain ?recordingActivity .\r\n  ?recordingActivityCarriedOutBy crm:P14.1_in_the_role_of ?role .\r\n  ?role rdfs:label ?roleLabel .\r\n  \r\n  ?publicProjectionEvent crm:P4_has_time-span ?timespan .\r\n  ?timespan crm:P82a_begin_of_the_begin ?releaseBegin .\r\n  ?timespan crm:P79_beginning_is_qualified_by ?releaseBegin .\r\n  ?timespan crm:P80_end_is_qualified_by ?releaseEnd .\r\n  \r\n  BIND(year(?releaseBegin) as ?year)\r\n  BIND(year(?releaseEnd) as ?year)\r\n}\r\nGROUP BY ?role ?roleLabel ?year\r\nORDER BY ?year ?roleLabel\r\n*/\r\n\r\n(function (d3) {\r\n  let margin = {\r\n    top: 50,\r\n    right: 80,\r\n    bottom: 50,\r\n    left: 80\r\n  }\r\n\r\n  let svgSize, graphSize\r\n\r\n  setSizing()\r\n\r\n\r\n\r\n  let data = [];\r\n  let roleGroups = groups.groups;\r\n  let roleColors = groups.colors\r\n\r\n  function loadViz3(scaleProperty) {\r\n    d3.csv('./data3.csv').then((roles) => {\r\n        let g = generateG(margin)\r\n\r\n        appendAxes(g)\r\n        appendGraphLabels(g)\r\n      \r\n        positionLabels(g, graphSize.width, graphSize.height)\r\n\r\n        let groupOrder = getSortedGroups(roles, roleGroups);\r\n        data = preprocess(roles, roleGroups, true);\r\n        \r\n        let xScale = setXScale(graphSize.width, data);\r\n        let yScale = setYScale(graphSize.height, data, roleGroups,scaleProperty);\r\n        let colorScale = setColorScale(roleGroups, roleColors);\r\n    \r\n        let sortedKeys = sortKeys(roleGroups, groupOrder);\r\n    \r\n        var stackedData = d3.stack()\r\n            .offset(d3.stackOffsetSilhouette)\r\n            .keys(sortedKeys)\r\n            .value((d,key) => d[key][scaleProperty])\r\n            (data);\r\n    \r\n        drawXAxis(xScale, graphSize.height)\r\n        drawYAxis(yScale)\r\n    \r\n        let area = d3.area()\r\n        .x(function(d, i) { return xScale(d.data.year); })\r\n        .y0(function(d) { return yScale(d[0]); })\r\n        .y1(function(d) { return yScale(d[1]); });\r\n    \r\n        var Tooltip = g\r\n            .append(\"text\")\r\n            .attr(\"x\", 0)\r\n            .attr(\"y\", 0)\r\n            .style(\"opacity\", 0)\r\n            .style(\"font-size\", 30)\r\n    \r\n        var mouseover = function(d) {\r\n            Tooltip.style(\"opacity\", 1)\r\n            d3.selectAll(\"#viz3 .myArea\").style(\"opacity\", .2)\r\n                .style('stroke-width', '1px');\r\n            d3.selectAll(\"#viz3 .myArea\")\r\n                .filter(a => roleGroups[a.key] == roleGroups[d.key])\r\n                .style(\"stroke\", \"black\")\r\n                .style(\"opacity\", 0.6);\r\n            d3.select(this)\r\n                .style(\"stroke\", \"black\")\r\n                .style(\"opacity\", 1)\r\n                .style('stroke-width', '2px');\r\n        }\r\n        var mousemove = function(d,i) {\r\n            //console.log( d3.event )\r\n            let text = \"\";\r\n            if (roleGroups[d.key] != groups.roles[d.key]) {\r\n                text = roleGroups[d.key] + \": \" + groups.roles[d.key];\r\n            } else {\r\n                text = roleGroups[d.key];\r\n            }\r\n            \r\n            Tooltip.text(text)\r\n        }\r\n        var mouseleave = function(d) {\r\n            Tooltip.style(\"opacity\", 0)\r\n            d3.selectAll(\"#viz3 .myArea\").style(\"opacity\", 1).style(\"stroke\", \"none\")\r\n        }\r\n    \r\n        g\r\n        .selectAll(\"mylayers\")\r\n        .data(stackedData)\r\n        .enter()\r\n        .append(\"path\")\r\n          .attr(\"class\", \"myArea\")\r\n          .style(\"fill\", function(d) { return colorScale(d.key); })\r\n          .attr(\"d\",area)\r\n          .on(\"mouseover\", mouseover)\r\n          .on(\"mousemove\", mousemove)\r\n          .on(\"mouseleave\", mouseleave);\r\n      })\r\n  }\r\n\r\n  loadViz3(\"count\")\r\n\r\n  document.getElementById(\"viz3-button\").addEventListener(\"click\", toggleProperty);\r\n\r\n  function toggleProperty() {\r\n    let button = document.getElementById(\"viz3-button\");\r\n    let property = button.getAttribute(\"value\")\r\n\r\n    d3.select(\"#viz3\").selectAll(\"*\").remove();\r\n\r\n    if (property == \"count\"){\r\n        button.setAttribute(\"value\", \"proportion\")\r\n        loadViz3(\"proportion\");\r\n        button.innerHTML = \"Total\"\r\n    } else {\r\n        button.setAttribute(\"value\", \"count\")\r\n        loadViz3(\"count\");\r\n        button.innerHTML = \"Proportion\"\r\n    }\r\n  }\r\n  \r\n  /**\r\n   *   This function handles the graph's sizing.\r\n   */\r\n   function setSizing () {\r\n    let graphWidth = Math.min(self.innerWidth, 1000);\r\n    let graphHeight = graphWidth * 0.6;\r\n\r\n    svgSize = {\r\n      width: graphWidth,\r\n      height: graphHeight\r\n    }\r\n\r\n    graphSize = {\r\n      width: svgSize.width - margin.right - margin.left,\r\n      height: svgSize.height - margin.bottom - margin.top\r\n    }\r\n\r\n    setCanvasSize(svgSize.width, svgSize.height)\r\n  }\r\n})(d3)\r\n\r\n  function preprocess(roles, groups, normalize=true) {\r\n      let data = []\r\n      let emptyGroups = {};\r\n      Object.keys(groups).forEach(key =>{\r\n          emptyGroups[key] = 0;\r\n      })\r\n\r\n      let thisYear = new Date().getFullYear();\r\n      let yearLimit = ((thisYear -5) - (thisYear -5) % 5) - 1;\r\n\r\n      roles.forEach(element => {\r\n          let roleId = parseInt(element.role.substr(44));\r\n          let year = element.year - element.year % 5;\r\n          if (year <= yearLimit) {\r\n            if (!data.find(d => d.year == year)){\r\n                let row = {'year':year};\r\n                Object.keys(groups).forEach(key =>{\r\n                  row[key] = 0;\r\n                })\r\n                data.push(row);\r\n            }\r\n  \r\n            data.find(d => d.year == year)[roleId] = parseInt(element.count);\r\n          }\r\n      });\r\n      if (normalize) {\r\n          data.forEach(d => {\r\n              let yearSum = 0;\r\n              Object.keys(groups).forEach(g => {\r\n                yearSum += d[g];\r\n              });\r\n              Object.keys(groups).forEach(g => {\r\n                d[g] = {'count':d[g], 'proportion':d[g]/yearSum};\r\n              });\r\n          })\r\n      }\r\n      return data;\r\n  }\r\n\r\n  function setXScale (width, data) {\r\n\treturn d3.scaleLinear()\r\n\t\t\t.domain(d3.extent(data, function(d) { return d.year; }))\r\n\t\t\t.range([0, width]);\r\n}\r\n\r\nfunction setYScale (height, data, roleGroups, scaleProperty) {\r\n\t// TODO : Define the linear scale in y for the scatter plot\r\n\tlet range = 0;\r\n\r\n    data.forEach(d => {\r\n        let rolesSum = 0;\r\n        Object.keys(roleGroups).forEach(key => {\r\n            if (d[key][scaleProperty]){\r\n                rolesSum += d[key][scaleProperty];\r\n            }\r\n        })\r\n        if (rolesSum > range){\r\n            range = rolesSum;\r\n        }\r\n    });\r\n\r\n\treturn d3.scaleLinear()\r\n        .domain([-1 * range / 2, range / 2])\r\n        .range([ height, 0 ]);\r\n}\r\n\r\nfunction setColorScale (roleGroups, groupsColors) {\r\n    let domain = [];\r\n    let colors = [];\r\n    Object.entries(roleGroups).forEach(r => {\r\n        domain.push(r[0]);\r\n        colors.push(groupsColors[r[1]]);\r\n    });\r\n    return d3.scaleOrdinal()\r\n        .domain(domain)\r\n        .range(colors);\r\n}\r\n\r\n/**\r\n * Draws the X axis at the bottom of the diagram.\r\n *\r\n * @param {*} xScale The scale to use to draw the axis\r\n * @param {number} height The height of the graphic\r\n */\r\nfunction drawXAxis (xScale, height) {\r\n    d3.select('#viz3 .x.axis')\r\n      .attr('transform', 'translate( 0, ' + height + ')')\r\n      .call(d3.axisBottom(xScale).tickSizeOuter(0).tickFormat(d3.format(\"d\")))//.tickArguments([5, '~s']))\r\n  }\r\n  \r\n  /**\r\n   * Draws the Y axis to the left of the diagram.\r\n   *\r\n   * @param {*} yScale The scale to use to draw the axis\r\n   */\r\nfunction drawYAxis (yScale) {\r\n    d3.select('#viz3 .y.axis')\r\n      .call(d3.axisLeft(yScale).tickSizeOuter(0).tickArguments([5, '.0r']))\r\n  }\r\n\r\nfunction getSortedGroups(data, groups){\r\n    let groupTotals = {};\r\n    data.forEach(d => {\r\n        let roleId = parseInt(d.role.substr(44));\r\n        if (!groupTotals[groups[roleId]]) {\r\n            groupTotals[groups[roleId]] = 0;\r\n        }\r\n        groupTotals[groups[roleId]] += parseInt(d.count);\r\n    })\r\n\r\n    return Object.entries(groupTotals).sort((a,b) => b[1] - a[1]).map(e => e[0]);    \r\n}\r\n\r\nfunction sortKeys(roles, order){\r\n    let sortedKeys = Object.entries(roles).sort((a,b) => {\r\n        let indexa = order.findIndex(r => r == a[1]);\r\n        let indexb = order.findIndex(r => r == b[1]);\r\n        if(indexa < indexb) { return -1; }\r\n        if(indexa > indexb) { return 1; }\r\n        return 0;\r\n    }).map(e => e[0]);\r\n    return sortedKeys;\r\n}\r\n\r\nfunction appendAxes (g) {\r\n    g.append('g')\r\n    .attr('class', 'x axis')\r\n}\r\n\r\nfunction appendGraphLabels (g) {\r\n    g.append('text')\r\n        .text('Année')\r\n        .attr('class', 'x axis-text')\r\n        .attr('font-size', 20)\r\n}\r\n\r\nfunction positionLabels (g, width, height) {\r\n    // TODO : Position axis labels\r\n      d3.select('#viz3 .y.axis-text')\r\n          .attr('x', -48)\r\n          .attr('y', height / 2)\r\n  \r\n      d3.select('#viz3 .x.axis-text')\r\n          .attr('x', width / 2)\r\n          .attr('y', height+40)\r\n  }\r\n\r\n function generateG (margin) {\r\n    return d3.select('.graph-viz3')\r\n      .select('svg')\r\n      .append('g')\r\n      .attr('id', 'graph-g')\r\n      .attr('transform',\r\n        'translate(' + margin.left + ',' + margin.top + ')')\r\n  }\r\n\r\n  function setCanvasSize (width, height) {\r\n    d3.select('#viz3')\r\n      .attr('width', width)\r\n      .attr('height', height)\r\n  }","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}